\chapter{Applications}\label{ch:Applications}
% TODO END: go through this chapter (and the others, probably) at the end and see if any comments with additional information can be put or merged anywhere.
\glijbaantje{If you find that you're spending almost all your time on theory,\\ start turning some attention to practical things; it will improve your theories.\\ If you find that you're spending almost all your time on practice,\\ start turning some attention to theoretical things; it will improve your practice.}{Donald Knuth}

\begin{adjustwidth}{2em}{2em} % TODO END: update once published.
	\begin{center}
		\textbf{Material from this chapter has also been published in:} \\
	\end{center}
	\vspace{1em}
	\begin{adjustwidth}{0em}{1.5em}
		\begin{itemize}
			\item[\cite{KUR-24}] A.~Kurenkov, J.~Maes, A.~Pac, G.~M.~Macauley, B.~Van~Waeyenberge, A.~Hrabec, and L.~J.~Heyderman.
			\newblock Perpendicular-anisotropy artificial spin ice with spontaneous ordering: a platform for neuromorphic computing with flexible timescales.
			\newblock \emph{ArXiV}, arXiv:\penalty0 2408.12182, 2024.
		\end{itemize}
	\end{adjustwidth}
	\vspace{.5em}
	\begin{center}
		\centering\rule{0.7\linewidth}{0.4pt}
	\end{center}
	\vspace{1em}
\end{adjustwidth}

Our main focus will be on out-of-plane systems. First, however, we will rather briefly discuss several in-plane cases.

\section{In-plane systems}
\subsection{Pinwheel reversal}\label{sec:3:IP_Pinwheel_reversal}
\subsection{Kagome reversal} % Q: move these reversals to the Hotspice chapter?
\subsection{RC by clocking in Pinwheel ASI}

\section{Reservoir computing in out-of-plane systems}
The main factor that attracted attention towards OOP ASI for RC, was that they allow very efficient and relatively simple input and read-out methods to be used.
Early on in the \spinengine project, methods to read the state of OOP ASI had already been demonstrated experimentally on a small scale by ETHZ/PSI.
However, their potential for RC had not yet been investigated.
As \hotspice is well-suited for the simulation of OOP ASI, this presented an appropriate use-case for the software developed in~\cref{ch:Hotspice}. % Furthermore, the other simulator developed by the consortium (flatspin) only supports in-plane magnetisation. Furthermore, \hotspice is more accurate for OOP ASI than IP ASI due to the high degree of symmetry in the former.
\par
Therefore, in this section \hotspice will be used to assess the viability and characteristics of a couple of methods to achieve RC in OOP ASI.
It will be shown that RC is indeed possible in such systems by using an appropriate input and readout protocol.
This section starts with a discussion of the basic properties of OOP ASI and the motivation for researching them.
Then, the section is divided into two main parts, discussing non-volatile and thermally active ASI. % At first, the fabricated OOP ASI were not thermally active, though ASI which spontaneously relaxed to a checkerboard state was achieved later.
\subsection{Characteristics of OOP ASI}
\subsubsection{Motivation} % Input and output
While it is possible to use an external field to switch both IP and OOP nanomagnets, this is undesirable in a real device due to stray fields and the need for bulky magnets.
The main allure of OOP ASI stems from the existence of efficient input and readout mechanisms for such OOP magnets.
Input can be applied via spin-orbit torque (SOT)~\cite{SOT_FM_AFM,SOTswitchingCoPt}, and the system can be read out using the anomalous Hall effect (AHE)~\cite{AHE}.
Both of these only require a current to be passed through an underlayer that is electrically connected to the sample, and were explained earlier in the introduction (\cref{sec:1:ASI_IO}).
% Nonetheless, external fields are often used for input anyway in the lab during the first stages of development, because they are easier to handle than the more complicated methods that would be used in a real device. By the end of the project, Alex had used SOT in his actual devices.

\subsubsection{Structure of OOP nanomagnets} % Co/Pt multilayer, energy contributions
\label{sec:3:OOP_nanomagnet_PMA}
Where IP magnets mostly rely on shape anisotropy to create an easy axis, OOP magnets can be realised using interfacial anisotropy between the ferromagnetic material and the substrate.
One example of this is found at the interface between \ce{Co} and \ce{Pt}, as was used in the experimental OOP ASI fabricated within the context of the \spinengine project.
This \idx{perpendicular magnetic anisotropy} (PMA) acts in the immediate vicinity of the interface, where the magnetisation then prefers to align perpendicular to said interface. \par
Typically, a number of \ce{Co}-\ce{Pt} interfaces are stacked vertically, with the number and thickness of \ce{Co} layers then controlling the OOP anisotropy.
The ferromagnetic layers in such stacks are typically made to be very thin for two main reasons.
Firstly, since the PMA only acts at the interface it does not increase for thicker layers.
Secondly, recall that the energy associated with \xref{shape anisotropy} increases with volume ($\EB=K_\mathrm{u}V$), so a maximal number of layers for a given amount of ferromagnetic material is preferable for PMA to counteract shape anisotropy. \par
Other factors contribute to the anisotropy as well, e.g. a non-linear dependence on the \ce{Pt} layer thickness due to the RKKY interaction~\cite{RKKY_RK,RKKY_K,RKKY_Y}.
However, this coupling is likely not dominant in a \ce{Co}-\ce{Pt} stack, as \ce{Pt} nearly satisfies the Stoner criterion~\cite{PtMagneticOrder}.
Since the \ce{Pt} is combined with a ferromagnetic material (\ce{Co}), it is thought that this induces a ferromagnetic coupling between \ce{Co} layers in spite of the RKKY interaction, for reasonable \ce{Pt} thicknesses~\cite{PerpendicularMagnetizationASI}.

\subsubsection{ASI ground state}
The ground state of any system being used for RC is of utmost importance; it dictates which input methods will induce desirable dynamics in the system and which input protocols will fall flat.
The ground state of most OOP spin ices is some form of anti-ferromagnetic (AFM) ordering, because the dipolar interaction will always encourage opposite magnetisation between any two neighbouring OOP magnets.
Depending on the particular lattice upon which the OOP magnets are placed, this may (e.g. triangle/Cairo; \crefSubFigRef{fig:2:ASIs}{j,l}) or may not (e.g. square/honeycomb; \crefSubFigRef{fig:2:ASIs}{i,k}) induce frustration in the system.
If no frustration is present, the symmetry of the system imposes exactly two opposite ground states.
If frustration is present, no real ground state exists apart from local interactions, though the simple two-fold symmetry will still be present, as in any ASI.
For the OOP square-lattice ASI in particular, which is the lattice we will consider throughout this chapter, the ground state is an AFM checkerboard pattern of `up' ($\uparrow$) and `down' ($\downarrow$) magnetisation.

\subsubsection{Input and readout: experiment to simulation}
\paragraph{Input by spin-orbit torque}
In the experimental system, the intent was to switch the OOP magnets using SOT~\cite{SOTswitchingCoPt}.
Compared to an \xref{external magnetic field}, this allows far greater control over the stimulus applied for each input bit, and can more easily be integrated on-chip without generating stray fields. \par
Since \hotspice does not work with torques, but rather with switching energies, SOT can not directly be modelled as a torque.
However, the net desired effect of SOT in our application is deterministic switching of magnets, which can be achieved in the presence of in-plane symmetry breaking~\cite{SOT_Roadmap}. % SOT_Roadmap mentions symmetry breaking several times, very useful resource
Broken symmetry creates a preferential magnetisation direction, which can be modelled in \hotspice as an additional external field $B_z$.
This is a crude approximation to fit SOT into the Ising-like model; the modelled field $B_z$ is not necessarily related to the field-like SOT torque~\cite{SOT_firstprinciplesCoPt}, though the SOT current density is likely non-linearly related to the modelled field $B_z$.
% In the case without symmetry breaking, the effect may be modelled as a temporary reduction of the PMA, as in reality a sufficiently strong SOT (applied over multiple $\tau_0$) will push the magnetic moment in-plane~\cite{SOT_Roadmap}, after which it falls back randomly (with higher likelihood to the lowest energy state, I suppose). But this approach raises multiple additional questions: is it meaningful to reduce the barrier only slightly?

\paragraph{Readout by anomalous Hall effect}
In our paper~\cite{KUR-24}, \textit{A. Kurenkov} experimentally demonstrated electrical readout of the average magnetisation $\mavg$ using the anomalous Hall effect~\cite{AHE}.
Therefore, $\mavg$ can be used as a magnetic state readout in the simulations.
However, for reservoir computing purposes, multiple readout values are beneficial, so the average magnetisation of each lattice column was used for the readout $y_i(t)$. % Fig. 6a

A discussion about the experimental feasibility of such a grid of local readouts is given in Supplementary Information 7 of our paper~\cite{KUR-24}.
In short, by adding more electrodes to the Hall bar --- the layer underneath the ASI used to measure the magnetic state through the AHE --- inhomogeneities in the current density distribution result in different currents flowing through the different nanomagnets.
This consequently results in unequal contributions to the Hall resistance, providing a way to differentiate between the different magnets.
Individual states of the nanomagnets, not just $\mavg$, can be extracted through a set of linear operations as detailed in the aforementioned Supplementary Information.
In the context of reservoir computing, this means that the use of this readout approach with multiple electrodes can be computationally equivalent to knowing the exact magnetic configuration of the system.


%We will later notice that simple stimuli are not sufficient for RC in this system, and instead more complicated patterns will have to be used to meaningfully address the system. However, the practical implementation of such complicated stimuli requires more complicated current line layouts, which also cannot interfere with the readout. This proves to be a conundrum, which I will address later again.

\subsection{RC in non-volatile OOP square ASI}
\subsubsection{Considerations for devising an appropriate input scheme}
\paragraph{Global field can not work} % Start with schemes that are not appropriate
\paragraph{AFM field can work}
\paragraph{Input encoding} % Binary vs. byte etc. Sigmoid thingy?
\subsubsection{Two-step input scheme: clocking} % With importance of E_B_std

\subsection{Thermally active OOP ASI}
\subsubsection{Energy contributions}
Thermally active OOP ASI are hard to manufacture, because they must strike a delicate balance between several strong energy contributions to end up in an OOP state with a net energy barrier of only several tens of $\kBT$ at most.
To appreciate this difficulty, let us first take a closer look at the various energy contributions in the system --- ranging from local anisotropy to large-scale interactions --- and their dependence on the geometrical structure of the OOP magnets.
\begin{enumerate}
	\item \textbf{Perpendicular magnetic anisotropy} constitutes the largest contribution to the total OOP anisotropy.
	Its interfacial origin and characteristics have been discussed earlier in this chapter (see \cref{sec:3:OOP_nanomagnet_PMA}). % Anisot E: \approx\SI{1.1e-16}{\joule}
	\item \textbf{Shape anisotropy}\indexlabel[nolabel]{shape anisotropy} of each layer due to their \xlabel[nolabel]{demagnetising field}.
	It is of a similar order of magnitude as the PMA, but of opposite sign, favouring an IP magnetisation rather than OOP.
	This contribution was also discussed earlier, see~\cref{sec:2:shape_anisotropy}~and~\ref{sec:3:OOP_nanomagnet_PMA}. % Demag E: \approx\SI{-1.6e-16}{\joule}
	\item \textbf{Inter-layer magnetostatic interaction}.
	The separate FM layers within a single stack also interact, as they can all be considered as separate vertically stacked magnets.
	This vertical stacking provides an additional contribution to the OOP anisotropy because, in general, the magnetisation of separate magnets prefers to point along the axis connecting those magnets.
	One can think of this effect as being similar to the shape anisotropy, but on the scale of separate layers rather than individual atomic magnetic moments.
	This contribution aids the PMA in stabilising the OOP anisotropy, counteracting the \xref{demagnetising field}, but is smaller in magnitude. % Cross MS E: \approx\SI{0.5e-16}{\joule}
	\item \textbf{Inter-magnet magnetostatic interaction} is the only contribution --- besides external input --- that distinguishes between the $\uparrow$ and $\downarrow$ magnetisation states.
	All aforementioned energy contributions are internal to individual OOP magnets, making the \xref{magnetostatic interaction} the sole reason for the AFM ground state of the OOP ASI. % E_MS: \lesssim\SI{1.1e-17}{\joule}
	\item \textbf{Input}.
	In simulations, an \xref{external magnetic field} is used as a proxy to model SOT.
\end{enumerate}
For a system to be thermally active, the first three of these contributions should mostly cancel out --- to the level where their combined influence is of the same order of magnitude as the inter-magnet magnetostatic interaction, which is usually at least an order of magnitude weaker than the other contributions separately.

\paragraph{Magnet geometry}
% The geometry of nanomagnets in an OOP ASI is shown schematically in~\cref{fig:3:OOP_geometry}.
% TODO: make own figure of nanomagnets?

The magnets considered here are round with a diameter $D_\mathrm{NM}$ and consist of $N_{\ce{Co}}$ layers of \ce{Co} with a thickness $t_{\ce{Co}}$, separated and surrounded by \ce{Pt} layers of thickness $t_{\ce{Pt}}$.
They are placed in an ASI where the lateral spacing between magnets is $S_\mathrm{ASI}$ --- resulting in a lattice parameter $a=D_\mathrm{NM}+S_\mathrm{ASI}$ in a square lattice. \par
These five geometrical parameters have a profound effect on the balance between the aforementioned energy contributions, as summarised in~\cref{tab:3:interactions_geometry}.
The polynomial dependence of some of these relations makes the system quite hard to control: a slight manufacturing difference can yield a vastly different net OOP anisotropy, possibly inhibiting the spontaneous formation of a checkerboard ground state.
Note that the magnetostatic interactions depend on the square of the ferromagnetic volume $V=n_{\ce{Co}} t_{\ce{Co}} D_\mathrm{NM}^2$.

\xtable[tab:3:interactions_geometry]{
	Dependence of the energy components present in OOP ASI on the geometrical parameters.
	$x$ represents the parameter above the column.
	The magnet centre-to-centre distance $r = D_\mathrm{NM} + S_\mathrm{ASI}$.
	PMA depends non-trivially on $t_{\ce{Pt}}$.
	Empty cells indicate no significant dependence.
}{
	\begin{tabular}{r|c|c|c|c|c}
		\multicolumn{1}{r}{} & \multicolumn{1}{c}{$t_{\ce{Co}}$} & \multicolumn{1}{c}{$n_{\ce{Co}}$} & \multicolumn{1}{c}{$D_\mathrm{NM}$} & \multicolumn{1}{c}{$t_{\ce{Pt}}$} & \multicolumn{1}{c}{$S_\mathrm{ASI}$} \\
		\hline \hline
		PMA (interfacial anisotropy) &  & $x$ & $x^2$ & $\aquarius$ &  \\
		\hline
		Shape anisotropy (demag) & $x^2$ & $x$ & $x^4$ &  &  \\
		\hline
		Inter-layer MS interaction & $x^2$ & $x^2$ & $x^4$ & $x^{(< -3)}$ &  \\
		\hline
		Inter-magnet MS interaction & $x^2$ & $x^2$ & $x^4$ &  & $r^{(< -3)}$ \\ % S_ASI: $>r^{-3} + \frac{3}{16}D_\mathrm{NM}^2 r^{-5} $
		\hline
		Input (external field) & $x$ & $x$ & $x^2$ &  &  \\
		\hline
	\end{tabular}
}

These five geometrical parameters are bounded by several physical and practical constraints.
Note that the numerical values of the limits given below are only indicative and may depend on the exact values of the other geometrical parameters.
\begin{itemize}
	\item \textbf{FM layer thickness} $\boldsymbol{t_{\ce{Co}}} \lesssim \SI{1.45}{\nano\metre}$. \newline
	This upper bound was experimentally determined~\cite{KUR-24} and is imposed by shape anisotropy.
	As mentioned earlier, the \xref{shape anisotropy} increases linearly with volume, and therefore with $t_{\ce{Co}}$, while the PMA is mostly independent of $t_{\ce{Co}}$. % t_{\ce{Co}} controls the demag compensation of $K_u$.
	For the magnets to remain OOP, the layers must therefore be sufficiently thin. \par
	The closer the thickness is to this upper bound, the lower the effective OOP anisotropy will be.
	Therefore, non-volatile ASI must steer clear of this limit, while thermally active ASI generally try to approach this limit as close as possible.
	As such, this geometrical parameter is often key for balancing the energy landscape.
	\item \textbf{Separation between magnets} $\boldsymbol{S_\mathrm{ASI}} \gtrsim \SI{20}{\nano\metre}$. \newline
	This constraint is of a practical nature, as the minimal size of lateral geometrical features is limited by the accuracy of the lithographic process. \par
	The separation only affects the strength of the magnetostatic interaction between neighbouring magnets, as approximated in \hotspice by \cref{eq:2:E_MS} and the second-order correction of \cref{eq:2:E_MS_order2}.
	In ASI, a strong MS coupling --- hence low $S_\mathrm{ASI}$ --- is often preferred.
	However, for thermally active ASI we will soon see that excessively strong MS coupling is detrimental, resulting in a ``sweet spot'' of MS coupling energies.
	\item \textbf{Number of layers} $\boldsymbol{n_{\ce{Co}}} \lesssim 8$. \newline
	This limit is of a practical nature as well, caused by property drift during deposition of successive layers. \par
	Note that the number of layers does not affect the balance between PMA and shape anisotropy, as the number of interfaces per amount of magnetic material remains constant.
	However, since MS interactions grow $\propto n_{\ce{Co}}^2$, the inter-layer coupling --- and with it the net OOP anisotropy --- becomes increasingly significant for a large number of layers.
	\item \textbf{Diameter} $\boldsymbol{D_\mathrm{NM}} \lesssim \SI{200}{\nano\metre}$. \newline
	Magnets wider than this limit were observed to take on multi-domain states~\cite{KUR-24}, as their demagnetisation energy becomes dominant due to its rapid $\propto D_\mathrm{NM}^4$ growth.
	Even though in-plane magnets without uniform magnetisation have been used for computation~\cite{gartside2022reconfigurable}, we did not intend to use this in the OOP systems.
	Furthermore, the \hotspice simulator requires a single-domain magnetisation state for its Ising-like model to be applicable. \par
	The diameter can be used to control the relative strength between PMA and shape anisotropy and greatly affects the inter-magnet MS coupling.
	\item \textbf{Spacer layer thickness} $\boldsymbol{t_{\ce{Pt}}} \approx \SI{0.8}{\nano\metre}$. \newline
	The spacer thickness must be chosen appropriately to promote FM coupling between layers while maintaining the interfacial anisotropy. % Accounting for various effects such as RKKY coupling
	A thin spacer is beneficial to the net OOP anisotropy due to the $\approx t_{\ce{Pt}}^{-3}$ inter-layer MS coupling dependence.
\end{itemize}

In the particular case of the thermally active OOP ASI fabricated within the \spinengine project, the nanomagnets consist of $n_{\ce{Co}}=7$ ferromagnetic layers of $D_\mathrm{NM}=\SI{170}{\nano\metre}$ diameter and $t_{\ce{Co}} \approx \SI{1.45}{\nano\metre}$ thickness, with $t_{\ce{Pt}} \approx \SI{0.8}{\nano\metre}$ spacing layers in between.
The edge-to-edge spacing between neighbouring magnets is \SI{30}{\nano\metre}, unless specified otherwise, with a saturation magnetisation $M_\mathrm{sat}=\SI{1063}{\kilo\ampere\per\metre}$~\cite{Msat_Co}.

\subsubsection{Relaxation characteristics}
To better inform our choices for RC in thermally active ASI, it is essential to familiarize ourselves with its spontaneous relaxation process.
In this section, we numerically investigate this process with \hotspice by initializing an OOP ASI in a uniform ($\uparrow$) state and subsequently observing its decay towards the checkerboard ground state over a certain timespan.
In the Ising-like model used by \hotspice, two essential system parameters remain, denoted as
\begin{itemize}[leftmargin=4.1em]
	\item[$\boldsymbol{\EEA}$ ---] the energy barrier of a single non-interacting OOP magnet due to the net OOP anisotropy.
	This is the combined contribution of PMA, shape anisotropy and the inter-layer magnetostatic interaction.
	\item[$\boldsymbol{\EMC}$ ---] the magnetostatic coupling energy between nearest neighbours.
	This is responsible for the relaxation to the ground state.
\end{itemize}
Due to the N\'eel-Arrhenius switching law~\eqref{eq:2:Néel}, it is more appropriate to write dimensionless energies ($\EEA/\kBT$ and $\EMC/\kBT$), as it is only this ratio --- not the absolute value of the energies or temperature --- that controls the switching time. \par
In real ASI, imperfections introduced during manufacturing will cause the geometry of separate magnets to differ slightly, which can yield significant variation in the net OOP anisotropy of different magnets.
In simulations, this will be modelled by a Gaussian spread on the net anisotropy $\EEA$: unless otherwise specified, a standard deviation $\sigma(\EEA) = \SI{5}{\percent}$ will be used.
This provides pinning sites for domain walls, which can make the relaxation process more reproducible.
Such ``consistent variation'' within a particular ASI could ultimately be beneficial to RC by providing a richer output space. \par
In total, the effective energy barrier $\EBeff$ of a magnet $i$ can be written symbolically as
\begin{equation}
	\label{eq:3:OOP_relaxation_EBeff}
	\EBeff{}_{,i}(t) = \EEA \Big(1 + \sigma\ab(\EEA) \hat{\chi}_i \Big) + \EMC \sum_j s_i(t) D_{ij} s_j(t) 
	% TODO: use structure from the paper, that will be better and more scientific like.
\end{equation}
with $\hat{\chi}_i$ a random value from a standard normal distribution and $D_{ij}$ a factor proportional to the magnetostatic interaction energy between magnets $i$ and $j$ when $s_i=s_j=+1$. \\\par

The relaxation process can be tracked by the average magnetisation $\mavg$ and the local antiferromagnetic order parameter $\qNN = (1 - \langle S_i S_{i+1} \rangle)/2$.
In the uniform state --- where all magnets collectively point $\uparrow$ --- their values are $\mavg=1$ and $\qNN=0$.
During relaxation, they transition to $\mavg=0$ and $\qNN=1$, corresponding to the checkerboard ground state.
Note that, while for a random state $\qNN \approx 0.5$, a value of $\qNN=0.5$ does not necessarily imply a random state. \par
\cref{fig:3:OOP_relaxation} shows relaxation profiles for several combinations of $\EEA$ and $\EMC$.
For each combination, the relaxation was run 200 times, with each run performing at most $40N$ switches using the first-switch method, or stopping if the maximum time $t_\mathrm{max}=\SI{e4}{\second}$ (the right edge of each panel) is reached.
In the figure, each trace consists of 3 areas: the mean, standard deviation and 1st/99th percentile of these 200 runs at any given time. 
This variance is partially due to the randomness of N\'eel-Arrhenius switching, but also because each run used unique randomly sampled $\EEA$ for individual magnets, in accordance with the $\sigma(\EEA) = \SI{5}{\percent}$ variation.

\paragraph{Logarithmic relaxation}
A lot of insight into the relaxation process can be gained from~\cref{fig:3:OOP_relaxation}.
Most strikingly, both $\mavg$ and (to a lesser extent) $\qNN$ trace a very straight line during relaxation when the time axis uses a logarithmic scale.
Because of this logarithmic relaxation, the first switches occur on a vastly different timescale than the last --- each subsequent switch occurs on average $x$ times later than the previous switch ($t_{i+1} = x t_i \Rightarrow t_n = t_0 x^n$). \par
The cause of this is the magnetostatic interaction\footnote{
	Without the \xref{magnetostatic interaction}, the system would simply be a non-interacting ensemble of nanomagnets, which is known to relax to the ground state exponentially.
	This is the opposite of logarithmic relaxation; the relevant quantities like $\mavg$ would instead show up as straight lines when using a logarithmic y-axis and linear time axis.
}.
Initially, all magnets are in a high-energy state as they all point in the same direction.
After a certain amount of time, a first magnet will switch, thereby slightly stabilising all other magnets in the ASI to some degree according to the second term of~\cref{eq:3:OOP_relaxation_EBeff}.
Whichever magnet randomly switches next will therefore experience a slightly higher effective energy barrier $\EBeff$ than before.
On average, this means that the effective barrier $\max(\EBeff)$ for the most unstable magnets in the system --- those most eager to switch next --- will increase linearly with the amount of switched magnets.
Due to the N\'eel-Arrhenius equation~\eqref{eq:2:Néel}, this translates to an exponentially increasing switching time. \\\par
This also explains the general trend of a less inclined slope for higher magnetostatic coupling $\EMC$: high coupling means a greater energy change per switch, and therefore a greater exponential increase in the switching time.
Meanwhile, the net OOP anisotropy $\EEA$ also affects the relaxation, but only its timescale: changing $\EEA$ does not affect the aforementioned slope but simply shifts the relaxation curves along the (logarithmic) time axis.
Therefore, accurate control of $\EEA$ on a scale of $\sim 10\kBT$ is required to manufacture an ASI that exhibits a particular relaxation timescale. \par
%Note that the change in slope and the offset compensate to some extent such that the final switches (near $\mavg \rightarrow 0$ occur around the same time, nearly independently of $\EMC$). \par
The effects of $\EMC$ and $\EEA$ can be captured by fitting a logarithmic curve to the mean relaxation curves of the nine panels in ~\cref{fig:3:OOP_relaxation}, yielding the general trends
\begin{equation}
	\mavg = a \log_{10}(t \nu_0) + b \quad \mathrm{with} \quad \begin{cases}
		a \approx -\frac{\kBT}{2\EMC} \, \mathrm{,} \\
		b \approx \frac{\kBT}{6\EMC}(\frac{\EEA}{\kBT} - 1.5) - 0.05 \, \mathrm{.}
	\end{cases}
\end{equation} % TODO: more rigorous fit?
%As such, the intercept of the fit for $\mavg=0$ is
%\begin{equation}
%	t_{\mavg=0} = \frac{10^{-b/a}}{\nu_0} = \frac{10^{\frac{\EEA - 0.3 \EMC}{3\kBT} - 0.5}}{\nu_0}
%\end{equation}

\xfig{3_OOP/OOP_relaxation.pdf}{
	\label{fig:3:OOP_relaxation}
	Dependence of the ordering timescale on the energy balance between net OOP anisotropy $\EEA$ and nearest-neighbour magnetostatic coupling $\EMC$ in an OOP square-lattice ASI with $11 \times 11$ spins.
	%This system size was chosen because it matched the size of our fabricated systems discussed later.
	The ASI is initialised in a uniform magnetic state with all spins pointing `up' and is released at $t = 0$, after which the lattice relaxes to lower energies.
	Blue traces show the evolution of the absolute value of the average magnetisation $\mavg$ while orange traces represent the local antiferromagnetic parameter $\qNN$.
	Each trace shows the mean (central line), standard deviation (central shaded area), and 1st/99th percentile (outer shaded area) of 200 repeated relaxations with randomly sampled $\EEA$ profiles.
	At most $40N$ switches are simulated for each relaxation.
	The green shaded region highlights the second stage of ordering, during which the slope of $\qNN$ decreases due to domain wall formation.
	The simulations were stopped after \SI{1e4}{\second} and the resulting final magnetic states are shown in \textbf{the insets}, where white (black) indicates up (down) spins.
}

\paragraph{Two-phase relaxation}
While $\mavg$ follows a nearly perfect logarithmic relaxation, the local AFM parameter $\qNN$ changes slope at some point --- most strikingly in panel 6 and 9 of~\cref{fig:3:OOP_relaxation}.
This slope change marks the transition between what we call stage $\circled{1}$ and stage $\circled{2}$ of the relaxation.
In the figure, stage $\circled{2}$ is indicated by the green shaded area. \par
This is to a large extent dictated by the net magnetisation of the four NN of each magnet in the system.
Magnets will prefer a magnetisation that points opposite to the majority of their nearest neighbours. 
During stage $\circled{1}$, a significant amount of magnets still have three or four nearest neighbours (NN) which have not yet switched --- see for example the final state (at \SI{e4}{\second}) of panel 2, shown in its inset: most magnets still point `up' (white).
In such a state, most magnets would still very much prefer to switch, and the aforementioned near-linear decrease of $\max(\EBeff)$ persists.
This is no longer the case in a system which has reached stage $\circled{2}$ --- in panel 3, which has barely reached the second stage, very few magnets with $\geq 3$ NN of the same orientation remain.
In stage $\circled{2}$, most magnets have reached a stable local checkerboard ground state.
However, as the ground state is twofold degenerate, the random initial switching will cause domains of both types to nucleate, ultimately separated by domain walls.
These domain walls are composed of magnets with $<4$ oppositely-magnetised NN, giving them a higher $\EMC$ than magnets in the ground state.
As such, the domain wall magnets will switch fastest, causing the domain walls to perform a random walk through the system, eventually disappearing at the edges of the ASI.
This is what occurs between panels 5 and 8 of~\cref{fig:3:OOP_relaxation}.
Unlike the constantly changing global environment of stage $\circled{1}$, domain wall magnets typically have only 1 or 2 oppositely-oriented NN and are embedded within checkerboard domains.
Therefore, the environment of these domain walls does not significantly change over time, unless they randomly encounter the edge of the system or annihilate each other.
As such, the order parameter does not increase logarithmically, but rather as a power-law typical for a random walk.
In~\cref{fig:3:OOP_relaxation}, the logarithmic time axis means this power-law shows up as a rather abrupt increase of $\qNN$ at some point in time.
The typical time at which this occurs is dictated by the mean switching time of a domain wall magnet, which depends on both $\EEA$ and $\EMC$.

\paragraph{Miscellaneous remarks}
Note that the random spread on $\mavg$ when it has reached zero is greater for larger $\EMC$.
This is because $\EMC$ is the only factor responsible for order in the system: if $\EMC$ is high, any magnet that switches away from the checkerboard order will switch back nearly instantly, limiting $\mavg$ to only a single magnet away from 0.
For low $\EMC$, this magnet is likely to wait longer to switch back, during which time other magnets way also spontaneously switch.
This increases the spread, and in the $\EMC \rightarrow 0$ limit the spread will be that of a superparamagnetic ensemble. \par
During the relaxation process, one may be inclined to draw the conclusion from~\cref{fig:3:OOP_relaxation} that larger $\EMC$ yields more random variation.
This is mostly an illusion due to the steep slope of the relaxation for low $\EMC$: while the lower slope for $\EMC$ increases the random variation along the temporal axis, the vertical spread actually decreases for larger $\EMC$. \par
Panels 7 and 8 were stopped prematurely as they exhibit a great number of switches already at the timescale of \SI{1}{\second} --- completing the simulation until \SI{e4}{\second} would take a prohibitively long time without added benefit.
The low dipolar coupling of panel 7 causes domain walls to never truly disappear from the system: the local AFM parameter gets stuck around $\qNN \approx 0.8$.

\xfig{3_OOP/OOP_relaxation_continuous.pdf}{
	\label{fig:3:OOP_relaxation_continuous}
	Phase diagrams of the average magnetisation $\mavg$ and the local antiferromagnetic parameter $\qNN$ as a function of net out-of-plane anisotropy $\EEA$ and nearest-neighbour magnetostatic coupling $\EMC$ at $t=\SI{e4}{\second}$.
	Five regions can be distinguished: $\mathrm{I}$ -- frozen state, $\mathrm{II}$ -- transient states, $\mathrm{III}$ -- state with domains and domain boundaries, $\mathrm{IV}$ -- checkerboard ordering, $\mathrm{V}$ -- superparamagnetic state.
	The white and black dotted line respectively correspond to $\mavg = 0.05$ and $\qNN = 0.95$.
	The nine panels of~\cref{fig:3:OOP_relaxation} are indicated by grey crosses.
	The three symbols correspond to the experimental lattices shown in~\cref{fig:3:OOP_relaxation_fit} with nanomagnet diameter $D_\mathrm{NM} = \SI{170}{\nano\metre}$, \ce{Co} thickness $t_{\ce{Co}} = \SI{1.45}{\nano\metre}$ and nanomagnet separations $S_\mathrm{ASI} = \SI{20}{\nano\metre}$ (circle), $S_\mathrm{ASI} = \SI{25}{\nano\metre}$ (triangle), $S_\mathrm{ASI} = \SI{30}{\nano\metre}$ (cross). % TODO: create and reference that figure
}

\paragraph{Summary}
In summary, two main trends were observed.
Firstly, increasing the magnetostatic coupling $\EMC$ causes the relaxation to occur over a larger amount of timescales.
Secondly, the net OOP anisotropy $\EEA$ controls the timescale of the relaxation but does not affect the amount of timescales over which the relaxation occurs.
For reservoir computing purposes, a sufficiently low $\EEA$ and $\EMC$ are required --- but not too low, to respectively maintain OOP anisotropy and a ground-state AFM ordering.

% The size of the ASI does not significantly affect the relaxation process, apart from reducing the spread on these traces.

\paragraph{Exchange-coupled system} % Could be omitted if not sufficiently worked out
\subsubsection{Fitting MFM images}\label{sec:3:OOP:MFM}
% TODO: extend this intro by saying that simple calculations based on the cosines and sines of the four interactions (recall: this was calculated by Alex using Mathematica) does not give a thermally active energy barrier. See the following comment for more details.
% In absence of the neighbors (i.e. no \code{externalddE}, their combined energy barrier is $\approx\SI{-3.6e-18}{\joule}=\SI{-22.5}{\electronvolt}=-871k_BT$ which is far too large to get thermal switching, and on top of that it is negative which means that the magnet would rather sit in-plane which is obviously not observed in reality. Curiously, Alex observes thermal relaxation nonetheless. The energy barrier discrepancy between Mathematica and reality could be due to non-coherent reversal, resulting in a lower energy barrier in reality.
% However, Alex said that the energy barriers calculated with Mathematica in this manner did not seem to be very accurate: in the simulation, they were several tens of \SI{}{\electronvolt} (read: many $k_B T$), while in reality he saw thermal relaxation upon removal of an external saturating stimulus.
\paragraph{Bayesian optimisation}
\paragraph{Results} % E_B etc.

\subsection{RC in thermally active OOP square ASI}
\subsubsection{Concept} % Lessons learnt from non-volatile ASI
\paragraph{Input torques: representation in \hotspice}
Contrary to the binary input in the non-volatile OOP ASI, thermally active ASI can be addressed by a continuous range of input.
The input --- in reality applied through spin-orbit torque --- was applied in the simulations in the form of an OOP magnetic field $B_z(t)$ acting on the entire system.
The field was scaled such that its OOP component extends from $B_0$ (minimum) to $B_1$ (maximum), i.e. $B_0 \leq B_z \leq B_1$.

\paragraph{Readout method}
The inverse mean squared error (1/MSE) between o(t) and the desired result (the sawtooth) was used as a performance metric.

\subsubsection{RC: signal transformation}
\paragraph{Motivation} % Why do signal transformation? (scalar, nonlinear, memory...)
\paragraph{Baseline}
\paragraph{Parameter dependencies}
\subparagraph{Field magnitude}
\subparagraph{Frequency}
\subparagraph{Gradient}
\subparagraph{System size and readout resolution}
\subparagraph{Exchange/no exchange}
\subparagraph{Transformation}
\paragraph{Bayesian optimisation: Mackey-Glass}
\paragraph{Reflecting on results} % Is the performance decent? Compare to literature. MSE is not an ideal parameter, should use something that accounts more for the general shape.
